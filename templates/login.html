<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Log in</title>
    <link href="{{url_for('static', filename='style/login.css')}}" rel="stylesheet">
</head>
<body>
    <div class="login-container">
        <div class="login-form">
            <h1>Log In</h1>
            <p>Welcome back! Please enter your credentials.</p>
            <hr>
            <div class="input-container">
                <label for="email">Email</label>
                <input type="text" id="email" name="email" required>
            </div>
            <div class="input-container">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="remember" name="remember">
                <label for="remember">Remember me</label>
            </div>
            <div class="button-container">
                <button id="submit">Log In</button>
            </div>
            <div class = "register-container">
                <p>Don't have an account? <a href="/register">Sign up now</a></p>
            </div>
        </div>
    </div>
    <script>
        let button = document.getElementById("submit");
        let in_email = document.getElementById("email");
        let in_password = document.getElementById("password");

        async function send_form() {
            if (in_email.value == "" || in_password.value == "") {
                alert("One of the fields is missing.");
                return;
            }

            try {
                const response = await fetch("{{url_for('api_login')}}", {
                    method: "POST",
                    headers: {
                    "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        email: in_email.value,
                        password: in_password.value
                    }),
                });
                
                const result = await response.json();
                if (result.error == false) {
                    window.location.href = "/home";
                } else {
                    alert("Error: "+ result.message);
                }
            } catch (error) {
                console.error("Error:", error);
                alert("Error (in console)");
            }
        }

        button.addEventListener("click", () => send_form());

        addEventListener("keypress", (event) => {
            if (event.key === "Enter") {send_form();} 
        });
    </script>
</body>
</html>