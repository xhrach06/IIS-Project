<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Register</title>
    <link href="{{url_for('static', filename='style/register.css')}}" rel="stylesheet">
</head>
<body>
    <div class="register-container">
        <div class="register-form">
            <h1>Sign Up</h1>
            <p>Please fill in this form to create an account.</p>
            <hr>
            <div class="input-container">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="input-container">
                <label for="surname">Surname</label>
                <input type="text" id="surname" name="surname" required>
            </div>
            <div class="input-container">
                <label for="email">Email</label>
                <input type="text" id="email" name="email" required>
            </div>
            <div class="input-container">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div class="input-container">
                <label for="repeat-password">Repeat Password</label>
                <input type="password" id="repeat-password" name="repeat-password" required>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="remember" name="remember">
                <label for="remember">Remember me</label>
            </div>
            <div class="button-container">
                <button id="submit-button" type="button">Sign Up</button>
            </div>
        </div>
    </div>
    <script>
        let button = document.getElementById("submit-button");
        let in_name = document.getElementById("name");
        let in_surname = document.getElementById("surname");
        let in_email = document.getElementById("email");
        let in_password = document.getElementById("password");
        let in_rep_password = document.getElementById("repeat-password");

        async function send_form() {
            if (in_name.value=="" || in_surname.value=="" || in_email.value=="" || in_password.value=="") {
                alert("One of the fields is missing.");
                return;
            }
    
            if (in_password.value != in_rep_password.value) {
                alert("Password does not match.");
                return;
            }

            try {
                const response = await fetch("{{url_for('api_reg')}}", {
                    method: "POST",
                    headers: {
                    "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        name: in_name.value,
                        surname: in_surname.value,
                        email: in_email.value,
                        password: in_password.value
                    }),
                });
                
                const result = await response.json();
                if (result.error == false) {
                    window.location.href = "/home";
                } else {
                    alert("Error: "+ result.message);
                }
            } catch (error) {
                console.error("Error:", error);
                alert("Error (in console)");
            }
        }
        
        button.addEventListener("click", () => send_form());

        addEventListener("keypress", (event) => {
            if (event.key === "Enter") {send_form();} 
        });
    </script>
</body>
</html>
